<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title>Temperature v11</title>
		<script src="https://code.jquery.com/jquery-3.5.1.js" integrity="sha256-QWo7LDvxbWT2tbbQ97B53yJnYU3WhH/C8ycbRAkjPDc="
			crossorigin="anonymous"></script>
		<script>
			function drawLine(temp,canvas){
				can = $(`#canvas${canvas}`)

				percent = 1 / 20 * temp - 0.5;

				t = (Math.abs(percent - 1)) * Math.PI
				x = Math.cos(t) * 100 + 100
				y = Math.sin(t) * -100 + 100

				line = `<line x1='100' y1='100' x2='${x}' y2='${y}' style="stroke:black;stroke-width:2" ></line>`
				if (percent > 0.5) {
					poly = `<polygon points="0,0,200,0,${x},${y},100,100,0,100" style="stroke:black;stroke-width:2; fill: red;"></polygon>`
					
				} else {
					poly = `<polygon points="0,0,${x},${y},100,100,0,100" style="fill: red;"></polygon>`
				}

				can.html(line.concat(poly))

			};
		
			$(document).ready(function(){

				setInterval(() => {
					outsideTemp = $.ajax({url:"https://api.openweathermap.org/data/2.5/weather?q=Dongen&appid=769e44c3a39cca083f7578744c3508fe",async:false,cache:false})["responseJSON"]['main']["temp"] - 273.15
					$('#temp2').text(outsideTemp.toFixed(1))
					drawLine(outsideTemp.toFixed(1),1)
					
					roomTemp = $.ajax({ url: "https://gastralgic-wildebeest-0107.dataplicity.io/", async: false, cache: false })["responseJSON"]["celsius"]
					$('#temp1').text(roomTemp)
					drawLine(roomTemp.toFixed(1),2)
				}, 5000);

			});
		</script>
	</head>
	<body>
		<div id="temp1"></div>
		<div id="temp2"></div>
		<svg id="canvas1" width='200' height="100" style='border: 1px solid red;'></svg>
		<svg id="canvas2" width='200' height="100" style='border: 1px solid red;'></svg>
	</body>
</html>
